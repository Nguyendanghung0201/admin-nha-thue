(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69d0afee"],{"4db5":function(t,e,i){"use strict";i("aa19")},aa19:function(t,e,i){},c1c8:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nk-content nk-content-fluid pt-0"},[e("div",{staticClass:"container-xl wide-lg"},[e("div",{staticClass:"nk-content-body"},[e("div",{staticClass:"content-page wide-md m-auto"},[e("div",{staticClass:"nk-block"},[e("div",{staticClass:"card card-bordered"},[e("div",{staticClass:"card-inner p-sm-5"},[t._m(0),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("Page min")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.pagemin,expression:"pagemin"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.pagemin},on:{input:function(e){e.target.composing||(t.pagemin=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("Page max")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.pagemax,expression:"pagemax"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.pagemax},on:{input:function(e){e.target.composing||(t.pagemax=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("cookie")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.cookie,expression:"cookie"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.cookie},on:{input:function(e){e.target.composing||(t.cookie=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("Tên file lưu")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-lg btn-primary",on:{click:function(e){return t.crawldulieu_list_nha()}}},[t._v("Bắt đầu crawl")])]),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-lg btn-primary",on:{click:function(e){return t.load_file()}}},[t._v("Load từ file")])]),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-lg btn-primary",on:{click:function(e){return t.Update_du_lieu()}}},[t._v("Cập nhật dữ liệu nhà")])])])])])]),t._m(1)]),e("div",{attrs:{id:"showdulieu"}},[e("section",[e("h1",[t._v("Dữ liệu ")]),t._m(2),e("div",{staticClass:"tbl-content"},[e("table",{attrs:{cellpadding:"0",cellspacing:"0"}},[e("tbody",{attrs:{id:"body_dulieu"}},t._l(t.list,(function(i,a){return e("tr",{key:a,class:t.current_update>a?"daxong":""},[e("th",[t._v(t._s(a+1))]),e("th",[t._v(t._s(i.name))]),e("th",{staticStyle:{width:"25%"}},[t._v(t._s(i.url))]),e("th",[t._v("đã crawl")])])})),0)])])])])])])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"nk-block-head-content"},[e("h3",{staticClass:"nk-block-title py-1 px-4 fw-normal text-dark w-fit-content mx-sm-auto mx-0"},[t._v(" Crawl du lieu")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"card card-bordered h-100"},[e("div",{staticClass:"card-inner"},[e("div",{staticClass:"card-head"},[e("h5",{staticClass:"card-title"},[t._v("Danh sach nha lay duoc")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"tbl-header"},[e("table",{attrs:{cellpadding:"0",cellspacing:"0",border:"0"}},[e("thead",[e("tr",[e("th",[t._v("stt")]),e("th",[t._v("Tên nhà")]),e("th",{staticStyle:{width:"25%"}},[t._v(" Link ngôi nhà")]),e("th",[t._v("Trạng thái")])])])])])}],l=(i("14d9"),{name:"Tool",metaInfo(){return{title:this.$t("menu.term_of_use")}},data(){return{url:"https://www.realnetpro.com/main.php?method=estate&display=building",load_first:!1,cookie:"",pagemin:0,pagemax:0,name:"",nhaGalist:[],listimage:[],current_update:0,list:[],detailHome:{address:"",along_id:0,area:"",city_id:0,dau_xe:"",detail_id:"",gia_thong:"",images:"",khuyenmai:0,lat_map:"",line:"",list_img_url:[],long_map:"",nam_xay:"",name:"",phi_dich_vu:"",date:"defaul",phone:"",price:"",province_id:0,real_id:"",status:1,thongtin_1:"",thongtin_2:"",thongtin_3:"",thongtin_4:"",tien_coc:"",toa_tang:"",web:""},proviceOptions:[],cityOptions:[],list_khuyen_mai:[],positon:!1}},methods:{crawldulieu_list_nha(){if(!this.url||!this.cookie||!this.pagemin||!this.pagemax||!this.name)return this.$alert("điền thong tin");this.savecooki(this.cookie);let t=this.cookie.indexOf("ini_pref=");if(-1==t)return this.$alert("Kiểm tra lại cookie");this.$store.dispatch("Home/crawldu_lieu_link_file",{url:this.url,cookie:this.cookie,pagemin:this.pagemin,pagemax:this.pagemax,name:this.name}).then(t=>{t.success?(this.savetenfile(this.name),t.data&&t.data.length>0&&(this.list=t.data.map(t=>{let e=t.real_id.slice(t.real_id.search("browsing_")+9,t.real_id.length);return t.url=`https://www.realnetpro.com/room_detail.php?id=${e}&type=room`,t.status=!1,t.detail_id=e,t}),setTimeout(()=>{this.batdaucrawl_tung_nha()},1e3))):this.$alert("Cập nhật lại cookie")}).catch(t=>{this.setFormError(t)}).finally(()=>{})},async batdau_cap_nhat_du_lieu(){let t=0;for(let e of this.list){this.current_update=t,t++;let i={mod:"delete",id:e.detail_id},a=await this.$store.dispatch("Home/deleteBuild",i);if(0===a.code&&a.success){let t=await this.crawl_detail_dulieu(e.url,e.detail_id);if(!t.status)return this.$alert("Quá trình crawl bị lỗi, hãy kiểm tra cookie và tiếp tục crawl")}}this.Update_du_lieu()},async batdaucrawl_tung_nha(){let t=0;for(let e of this.list){this.current_update=t,t++;let i=await this.crawl_detail_dulieu(e.url,e.detail_id);if(!i.status)return this.$alert("Quá trình crawl bị lỗi, hãy kiểm tra cookie và tiếp tục crawl")}return this.$alert("đã crawl xong")},async rapdulieu(t,e,i,a){try{var s,l,n,o,r,c,d,u,h,m,p,_,g,f,v,y;let{imageavt:k,list_img_url:w,list_infor:b,vido:x}=t;if(!k||!w||!b||0==b.length||!x)return{status:!1,code:4};let C=w.split(",").filter(t=>t),$=b.filter(t=>"所在地"==t.key)[0].value2.replace("Show map","").replace("View map",""),K=b.filter(t=>"所在地"==t.key)[0].value,N=b.filter(t=>"間取"==t.key)[0].value2,O="";N&&(N=N.replace(/&nbsp;/g,""),N.includes("1R")&&(O="1R"),(N.includes("1K")||N.includes("1DK")||N.includes("1LDK"))&&(O="1K"),(N.includes("2K")||N.includes("2DK")||N.includes("2LDK"))&&(O="2K"),(N.includes("3K")||N.includes("3DK")||N.includes("3LDK"))&&(O="3K"));let H=null!==(s=null===(l=b.filter(t=>"駐車場"==t.key)[0])||void 0===l?void 0:l.value2)&&void 0!==s?s:"",G=null!==(n=null===(o=b.filter(t=>"交通"==t.key)[0])||void 0===o?void 0:o.value2)&&void 0!==n?n:"",L=null!==(r=null===(c=b.filter(t=>"交通"==t.key)[0])||void 0===c?void 0:c.value)&&void 0!==r?r:"",D=null!==(d=null===(u=b.filter(t=>"号室名"==t.key)[0])||void 0===u?void 0:u.value2)&&void 0!==d?d:"",P=null!==(h=null===(m=b.filter(t=>"物件名"==t.key)[0])||void 0===m?void 0:m.value)&&void 0!==h?h:"",S=null!==(p=null===(_=b.filter(t=>"築年月"==t.key)[0])||void 0===_?void 0:_.value2)&&void 0!==p?p:"",T=null!==(g=null===(f=b.filter(t=>"賃料 / 管理費・共益費"==t.key)[0])||void 0===f?void 0:f.value2)&&void 0!==g?g:"",J=null!==(v=null===(y=b.filter(t=>"敷金 / 礼金"==t.key)[0])||void 0===y?void 0:y.value2)&&void 0!==v?v:"",B="",I="";T&&(B=T.slice(0,T.indexOf("/")),I=T.slice(T.indexOf("/")+1,T.length));let A="",E="";J&&(A=J.slice(0,J.indexOf("Key Money")),E=J.slice(J.indexOf("Key Money"),J.length));let F=x.indexOf("&q="),U=x.indexOf("&zoom"),M=x.slice(F+3,U),Q=M.split(","),R=Q[0],j=Q[1];this.listimage=C;let q=0;if($){let t=this.phanloadCity($);if(t.status)q=t.data.id;else{let t=this.phanloadCityJp(K);t.status&&(q=t.data.id)}}let z=0;if(G){let t=this.phanloadCityNhaGa(G);if(t.status)z=t.data.id;else{let t=this.phanloadCityNhaGaJp(L);t.status&&(z=t.data.id)}}let V={address:$,along_id:z,area:N,city_id:q,dau_xe:H,detail_id:a,gia_thong:G,images:k,khuyenmai:0,lat_map:R,line:G,list_img_url:w,long_map:j,nam_xay:S,room_number:D,name:P,phi_dich_vu:I,date:"defaul",phone:"",kieu_phong:O,price:B,province_id:e,real_id:a,status:1,thongtin_1:"",thongtin_2:"",thongtin_3:"",thongtin_4:"",tien_coc:A,tien_le:E,toa_tang:"",web:i};return await this.saveBuild(V)}catch(k){return console.log("e ",k),{status:!1,code:6,err:k}}},async crawl_detail_dulieu(t,e){if(!t||!this.cookie||!e)return{status:!1,code:1};let i=this.cookie.indexOf("ini_pref=");if(-1==i)return{status:!1,code:2};let a=this.cookie.slice(i+9,i+11);!1===this.load_first&&(await this.getListCity(a),await this.getListNhaGa(a),this.load_first=!0);let s=await this.$store.dispatch("Home/crawldu_lieu",{url:t,cookie:this.cookie,id:e});if(s.success){let i=s.data;return s.pass?{status:!0}:await this.rapdulieu(i,a,t,e)}return{status:!1,code:3}},getlistProvince(){this.$store.dispatch("Home/listProvice").then(t=>{0===t.code&&t.success&&(this.proviceOptions=t.data)}).catch(t=>{this.setFormError(t)}).finally(()=>{})},async getListCity(t){let e={id:t},i=await this.$store.dispatch("Home/listCity",e);0===i.code&&i.success&&(this.cityOptions=i.data)},getListKhuyenmai(){this.$store.dispatch("Home/getlistKhuyenmai").then(t=>{0===t.code&&t.success&&(this.list_khuyen_mai=t.data)}).catch(t=>{this.setFormError(t)}).finally(()=>{})},async getListNhaGa(t){let e={id:t},i=await this.$store.dispatch("Home/listAlong",e);0===i.code&&i.success&&(this.nhaGalist=i.data)},phanloadCity(t){let e=[];for(let i of this.cityOptions)t.includes(i.name_en)&&e.push(i);return 0===e.length?{status:!1,msg:"Không xác định được thành phố"}:1===e.length?{status:!0,msg:"Đã xác định được thành phố",data:e[0]}:e.length>1?{status:!1,msg:"NHiều vị trí đươc xác định",data:e[0]}:void 0},phanloadCityNhaGa(t){let e=this.nhaGalist.map(t=>(t.name=t.along_name_en,t)),i=[];for(let a of e)t.includes(a.along_name_en)&&i.push(a);return 0===i.length?{status:!1,msg:"Không xác định được Nhà Ga"}:1===i.length?{status:!0,msg:"Đã xác định được thành phố",data:i[0]}:i.length>1?{status:!1,msg:"NHiều vị trí đươc xác định",data:i[0]}:void 0},phanloadCityJp(t){let e=[];for(let i of this.cityOptions)t.includes(i.name)&&e.push(i);if(0===e.length){let e=0,i=[];for(let s of this.cityOptions){let a=s.name.split(""),l=0;for(let e of a)t.includes(e)&&l++;i.push({index:e,count:l}),e++}i.sort((function(t,e){return t.count>e.count?-1:t.count<e.count?1:0}));let a=i[0];return{status:!0,msg:"xác định dk r",data:this.cityOptions[a.index]}}return 1===e.length?{status:!0,msg:"Đã xác định được thành phố",data:e[0]}:e.length>1?{status:!1,msg:"NHiều vị trí đươc xác định",data:e[0]}:void 0},phanloadCityNhaGaJp(t){let e=[];for(let i of this.nhaGalist)t.includes(i.AlongName)&&e.push(i);if(0===e.length){let e=0,i=[];for(let s of this.nhaGalist){let a=s.AlongName.split(""),l=0;for(let e of a)t.includes(e)&&l++;i.push({index:e,count:l}),e++}i.sort((function(t,e){return t.count>e.count?-1:t.count<e.count?1:0}));let a=i[0];return{status:!0,msg:"xác định dk r",data:this.nhaGalist[a.index]}}return 1===e.length?{status:!0,msg:"Đã xác định được thành phố",data:e[0]}:e.length>1?{status:!1,msg:"NHiều vị trí đươc xác định",data:e[0]}:void 0},async saveBuild(t){if(t.address&&t.area&&t.price&&t.long_map&&t.lat_map){let e=await this.$store.dispatch("Home/addBuilding2",{mod:"add",list:t});return e.success?{status:!0,code:0}:{status:!1,code:8}}return{status:!1,code:7}},savecooki(t){localStorage.setItem("cookiereal",t)},savetenfile(t){localStorage.setItem("file_name",t)},async load_file(){if(!this.cookie||!this.name)return this.$alert("điền thong tin");this.savecooki(this.cookie);let t=await this.$store.dispatch("Home/getinfor_file",{name:this.name});t.success&&t.data&&t.data.data.length>0&&(this.list=t.data.data.map(t=>{let e=t.real_id.slice(t.real_id.search("browsing_")+9,t.real_id.length);return t.url=`https://www.realnetpro.com/room_detail.php?id=${e}&type=room`,t.status=!1,t.detail_id=e,t}),setTimeout(()=>{this.batdaucrawl_tung_nha()},1e3))},async Update_du_lieu(){let t=await this.$store.dispatch("Dashboard/update_date_build");if(!this.cookie)return this.$alert("điền thong tin");if(this.savecooki(this.cookie),t.success){if(t.done)return this.$alert("Cập nhật dữ liệu đã xong");this.list=t.data.data.map(t=>(t.url=`https://www.realnetpro.com/room_detail.php?id=${t.detail_id}&type=room`,t.status=!1,t)),setTimeout(()=>{this.batdau_cap_nhat_du_lieu()},1e3)}}},mounted(){this.getlistProvince(),this.getListKhuyenmai();let t=localStorage.getItem("cookiereal");t&&(this.cookie=t);let e=localStorage.getItem("file_name");e&&(this.name=e)}}),n=l,o=(i("ee55"),i("4db5"),i("2877")),r=Object(o["a"])(n,a,s,!1,null,"18b77ed4",null);e["default"]=r.exports},cd71:function(t,e,i){},ee55:function(t,e,i){"use strict";i("cd71")}}]);