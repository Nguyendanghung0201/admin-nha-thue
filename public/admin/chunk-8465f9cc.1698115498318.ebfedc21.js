(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8465f9cc"],{"0717":function(t,e,i){},"47ac":function(t,e,i){"use strict";i("af42")},"5be4":function(t,e,i){"use strict";i("0717")},af42:function(t,e,i){},c1c8:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nk-content nk-content-fluid pt-0"},[e("div",{staticClass:"container-xl wide-lg"},[e("div",{staticClass:"nk-content-body"},[e("div",{staticClass:"content-page wide-md m-auto"},[e("div",{staticClass:"nk-block"},[e("div",{staticClass:"card card-bordered"},[e("div",{staticClass:"card-inner p-sm-5"},[t._m(0),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("Page min")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.pagemin,expression:"pagemin"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.pagemin},on:{input:function(e){e.target.composing||(t.pagemin=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("Page max")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.pagemax,expression:"pagemax"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.pagemax},on:{input:function(e){e.target.composing||(t.pagemax=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("cookie")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.cookie,expression:"cookie"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.cookie},on:{input:function(e){e.target.composing||(t.cookie=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"full-name"}},[t._v("Tên file lưu")]),e("div",{staticClass:"form-control-wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",id:"full-name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-lg btn-primary",on:{click:function(e){return t.crawldulieu_list_nha()}}},[t._v("Bắt đầu crawl")])]),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-lg btn-primary",on:{click:function(e){return t.load_file()}}},[t._v("Load từ file")])])])])])]),t._m(1)]),e("div",{attrs:{id:"showdulieu"}},[e("section",[e("h1",[t._v("Dữ liệu ")]),t._m(2),e("div",{staticClass:"tbl-content"},[e("table",{attrs:{cellpadding:"0",cellspacing:"0"}},[e("tbody",{attrs:{id:"body_dulieu"}},t._l(t.list,(function(i,a){return e("tr",{key:a,class:t.current_update>a?"daxong":""},[e("th",[t._v(t._s(a+1))]),e("th",[t._v(t._s(i.name))]),e("th",{staticStyle:{width:"25%"}},[t._v(t._s(i.url))]),e("th",[t._v("đã crawl")])])})),0)])])])])])])},l=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"nk-block-head-content"},[e("h3",{staticClass:"nk-block-title py-1 px-4 fw-normal text-dark w-fit-content mx-sm-auto mx-0"},[t._v(" Crawl du lieu")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"card card-bordered h-100"},[e("div",{staticClass:"card-inner"},[e("div",{staticClass:"card-head"},[e("h5",{staticClass:"card-title"},[t._v("Danh sach nha lay duoc")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"tbl-header"},[e("table",{attrs:{cellpadding:"0",cellspacing:"0",border:"0"}},[e("thead",[e("tr",[e("th",[t._v("stt")]),e("th",[t._v("Tên nhà")]),e("th",{staticStyle:{width:"25%"}},[t._v(" Link ngôi nhà")]),e("th",[t._v("Trạng thái")])])])])])}],s={name:"Tool",metaInfo(){return{title:this.$t("menu.term_of_use")}},data(){return{url:"https://www.realnetpro.com/main.php?method=estate&display=building",load_first:!1,cookie:"",pagemin:0,pagemax:0,name:"",nhaGalist:[],listimage:[],current_update:0,list:[],detailHome:{address:"",along_id:0,area:"",city_id:0,dau_xe:"",detail_id:"",gia_thong:"",images:"",khuyenmai:0,lat_map:"",line:"",list_img_url:[],long_map:"",nam_xay:"",name:"",phi_dich_vu:"",date:"defaul",phone:"",price:"",province_id:0,real_id:"",status:1,thongtin_1:"",thongtin_2:"",thongtin_3:"",thongtin_4:"",tien_coc:"",toa_tang:"",web:""},proviceOptions:[],cityOptions:[],list_khuyen_mai:[],positon:!1}},methods:{crawldulieu_list_nha(){if(!this.url||!this.cookie||!this.pagemin||!this.pagemax||!this.name)return this.$alert("điền thong tin");this.savecooki(this.cookie);let t=this.cookie.indexOf("ini_pref=");if(-1==t)return this.$alert("Kiểm tra lại cookie");this.$store.dispatch("Home/crawldu_lieu_link_file",{url:this.url,cookie:this.cookie,pagemin:this.pagemin,pagemax:this.pagemax,name:this.name}).then(t=>{t.success?(this.savetenfile(this.name),t.data&&t.data.length>0&&(this.list=t.data.map(t=>{let e=t.real_id.slice(t.real_id.search("browsing_")+9,t.real_id.length);return t.url=`https://www.realnetpro.com/room_detail.php?id=${e}&type=room`,t.status=!1,t.detail_id=e,t}),setTimeout(()=>{this.batdaucrawl_tung_nha()},1e3))):this.$alert("Cập nhật lại cookie")}).catch(t=>{this.$alert("Cập nhật lại cookie"),this.setFormError(t)}).finally(()=>{})},async batdau_cap_nhat_du_lieu(){let t=0;for(let e of this.list){this.current_update=t,t++;let i={mod:"delete",id:e.detail_id},a=await this.$store.dispatch("Home/deleteBuild",i);if(0===a.code&&a.success){let t=await this.crawl_detail_dulieu(e.url,e.detail_id);if(!t.status)return this.$alert("Quá trình crawl bị lỗi, hãy kiểm tra cookie và tiếp tục crawl")}}this.Update_du_lieu()},async batdaucrawl_tung_nha(){let t=0;for(let e of this.list){this.current_update=t,t++;let i=await this.crawl_detail_dulieu(e.url,e.detail_id);if(!i.status)return this.$alert("Quá trình crawl bị lỗi, hãy kiểm tra cookie và tiếp tục crawl")}return this.$alert("đã crawl xong")},async rapdulieu(t,e,i,a){try{var l,s,n,o,r,d,c,u,h,m,_,p,f,v,g,k,w,y;let{imageavt:b,list_img_url:x,list_infor:C,vido:$}=t;if(!b||!x||!C||0==C.length||!$)return{status:!1,code:4};let O=x.split(",").filter(t=>t),K=C.filter(t=>"所在地"==t.key)[0].value.replace("地図を見る","").replace("地図を見る",""),D=(C.filter(t=>"所在地"==t.key)[0].value,C.filter(t=>"間取"==t.key)[0].value),P="";D&&(D=D.replace(/&nbsp;/g,""),D.includes("1R")&&(P="1R"),(D.includes("1K")||D.includes("1DK")||D.includes("1LDK"))&&(P="1K"),(D.includes("2K")||D.includes("2DK")||D.includes("2LDK"))&&(P="2K"),(D.includes("3K")||D.includes("3DK")||D.includes("3LDK"))&&(P="3K"));let T=null!==(l=null===(s=C.filter(t=>"駐車場"==t.key)[0])||void 0===s?void 0:s.value)&&void 0!==l?l:"",H=null!==(n=null===(o=C.filter(t=>"交通"==t.key)[0])||void 0===o?void 0:o.value)&&void 0!==n?n:"",S=null!==(r=null===(d=C.filter(t=>"交通"==t.key)[0])||void 0===d?void 0:d.value2)&&void 0!==r?r:"",B=(c=null===(u=C.filter(t=>"交通"==t.key)[0])||void 0===u?void 0:u.value,null!==(h=null===(m=C.filter(t=>"号室名"==t.key)[0])||void 0===m?void 0:m.value)&&void 0!==h?h:""),I=null!==(_=null===(p=C.filter(t=>"物件名"==t.key)[0])||void 0===p?void 0:p.value)&&void 0!==_?_:"",L=null!==(f=null===(v=C.filter(t=>"築年月"==t.key)[0])||void 0===v?void 0:v.value)&&void 0!==f?f:"",j=null!==(g=null===(k=C.filter(t=>"賃料 / 管理費・共益費"==t.key)[0])||void 0===k?void 0:k.value)&&void 0!==g?g:"",N=null!==(w=null===(y=C.filter(t=>"敷金 / 礼金"==t.key)[0])||void 0===y?void 0:y.value)&&void 0!==w?w:"",J="",R="";const E=/(JPY|\d+)/g;if(j){J=j.slice(0,j.indexOf("/")),R=j.slice(j.indexOf("/")+1,j.length);let t=R.match(E);R=t?t.join(""):""}let Q="",U="";if(N){let t=N.indexOf("敷金");if(-1!=t&&(Q=N.slice(0,t)),Q&&-1!=Q.indexOf("円")){let t=Q.match(E);Q=t?t.join(""):""}if(-1!=N.indexOf("礼金")&&(U=N.slice(N.indexOf("礼金"),N.length),U&&-1!=U.indexOf("円"))){let t=U.match(E);U=t?t.join(""):""}}let q=$.indexOf("&q="),z=$.indexOf("&zoom"),F=$.slice(q+3,z),G=F.split(","),Y=G[0],A=G[1];this.listimage=O;let M=0,V=0,W=C.filter(t=>"所在地"==t.key)[0].value2+"-"+K+"-"+H+"-"+S,X={address:K,along_id:V,area:D,city_id:M,dau_xe:T,detail_id:a+"RE",gia_thong:H,images:b,khuyenmai:0,lat_map:Y,line:H,list_img_url:x,long_map:A,nam_xay:L,room_number:B,name:I,search_key:W,phi_dich_vu:R,date:"defaul",phone:"",kieu_phong:P,price:J,province_id:e,real_id:a,status:1,thongtin_1:"",thongtin_2:"",thongtin_3:"",thongtin_4:"",tien_coc:Q,tien_le:U,toa_tang:"",web:i};return await this.saveBuild(X)}catch(b){return console.log("e ",b),{status:!1,code:6,err:b}}},async crawl_detail_dulieu(t,e){if(!t||!this.cookie||!e)return{status:!1,code:1};let i=this.cookie.indexOf("ini_pref=");if(-1==i)return{status:!1,code:2};let a=this.cookie.slice(i+9,i+11);!1===this.load_first&&(this.load_first=!0);let l=await this.$store.dispatch("Home/crawldu_lieu",{url:t,cookie:this.cookie,id:e});if(l.success){let i=l.data;return l.pass?{status:!0}:l.data&&l.data.list_infor&&l.data.list_infor.length&&l.data.imageavt?await this.rapdulieu(i,a,t,e):{status:!1,code:4}}return{status:!1,code:3}},async saveBuild(t){if(t.address&&t.area&&t.price&&t.long_map&&t.lat_map){let e=await this.$store.dispatch("Home/addBuilding2",{mod:"add",list:t});return e.success?{status:!0,code:0}:{status:!1,code:8}}return{status:!1,code:7}},savecooki(t){localStorage.setItem("cookiereal",t)},savetenfile(t){localStorage.setItem("file_name",t)},async load_file(){if(!this.cookie||!this.name)return this.$alert("điền thong tin");this.savecooki(this.cookie);let t=await this.$store.dispatch("Home/getinfor_file",{name:this.name});t.success&&t.data&&t.data.data.length>0&&(this.list=t.data.data.map(t=>{let e=t.real_id.slice(t.real_id.search("browsing_")+9,t.real_id.length);return t.url=`https://www.realnetpro.com/room_detail.php?id=${e}&type=room`,t.status=!1,t.detail_id=e,t}),setTimeout(()=>{this.batdaucrawl_tung_nha()},1e3))},async Update_du_lieu(){let t=await this.$store.dispatch("Dashboard/update_date_build");if(!this.cookie)return this.$alert("điền thong tin");if(this.savecooki(this.cookie),t.success){if(t.done)return this.$alert("Cập nhật dữ liệu đã xong");this.list=t.data.data.map(t=>(t.url=`https://www.realnetpro.com/room_detail.php?id=${t.detail_id}&type=room`,t.status=!1,t)),setTimeout(()=>{this.batdau_cap_nhat_du_lieu()},1e3)}}},mounted(){let t=localStorage.getItem("cookiereal");t&&(this.cookie=t);let e=localStorage.getItem("file_name");e&&(this.name=e)}},n=s,o=(i("5be4"),i("47ac"),i("2877")),r=Object(o["a"])(n,a,l,!1,null,"91c600c6",null);e["default"]=r.exports}}]);